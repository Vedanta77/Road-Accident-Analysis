-- ------------------------------------------------------------
-- ROAD ACCIDENT ANALYSIS - SQL QUERIES 
select * from road_accident;

--Total Casulties 2021-2022--
select sum(number_of_casualties) as CY_Casualties
from road_accident
where YEAR(accident_date) = '2022' AND road_surface_conditions= 'Dry'

-- CY accidents 2022--
SELECT COUNT(DISTINCT accident_index) as CY_Accidents
from road_accident
where year(accident_date)='2022';

-- fatal casualties of CY 2022--
SELECT sum(number_of_casualties) as CY_Fatal_Casualties
from road_accident
where year(accident_date)='2022' and accident_severity = 'Fatal';

--serious casualties of 2022 CY--
SELECT sum(number_of_casualties) as CY_Serious_Casualties
from road_accident
where year(accident_date)='2022' and accident_severity = 'Serious';

--Slight Casualties CY 2022--
SELECT sum(number_of_casualties) as CY_Slight_Casualties
from road_accident
where year(accident_date)='2022' and accident_severity = 'Slight';

--Percentage of slight accident as compared to total accidents--
SELECT cast(sum(number_of_casualties) as decimal(10,2))* 100/ 
(Select cast(sum(number_of_casualties) as decimal(10,2)) from road_accident) as PCT 
from road_accident
where accident_severity = 'Slight';

--Percentage of serious accident as compared to total accidents--
SELECT cast(sum(number_of_casualties) as decimal(10,2))* 100/ 
(Select cast(sum(number_of_casualties) as decimal(10,2)) from road_accident) as PCT 
from road_accident
where accident_severity = 'Serious';

--Percentage of Fatal accident as compared to total accidents--
SELECT cast(sum(number_of_casualties) as decimal(10,2))* 100/ 
(Select cast(sum(number_of_casualties) as decimal(10,2)) from road_accident) as PCT 
from road_accident
where accident_severity = 'Fatal';


--SECONDARY KPIS--
SELECT* FROM road_accident;

-- month wise total no. of casualties in 2022--
select datename(month, accident_date) as month_name , sum(number_of_casualties) as CY_Casualties
from road_accident
where year(accident_date) = '2022'
group by datename(month, accident_date)

--casualties for road--
select road_type, sum(number_of_casualties) as CY_Casualties
from road_accident
where year(accident_date) ='2022'
group by road_type


-- casualties urban or rural area--
select urban_or_rural_area, sum(number_of_casualties) as Total_Casualties,cast(sum(number_of_casualties) as decimal(10,2)) *100 / 
(select cast(sum(number_of_casualties) as decimal(10,2)) from road_accident where year(accident_date)= '2022') as PCT
from road_accident 
where year(accident_date)= '2022'
group by urban_or_rural_area


-- top 10 casualties local authority wise--
select TOP 10 local_authority, sum(number_of_casualties) as Total_Casualties
from road_accident
group by local_authority 
order by Total_Casualties desc



-- End of script
